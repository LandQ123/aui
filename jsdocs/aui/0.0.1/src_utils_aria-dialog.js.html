<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>src/utils/aria-dialog.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="aria.html">aria</a></li><li><a href="module-Date-fecha.html">fecha</a></li><li><a href="module-TableStoreModule-TableStore.html">TableStore</a><ul class='methods'><li data-type='method'><a href="module-TableStoreModule-TableStore.html#cleanSelection">cleanSelection</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#clearFilter">clearFilter</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#clearSelection">clearSelection</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#clearSort">clearSort</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#commit">commit</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#isRowExpanded">isRowExpanded</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#isSelected">isSelected</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#scheduleLayout">scheduleLayout</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#setCurrentRowKey">setCurrentRowKey</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#setExpandRowKeys">setExpandRowKeys</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#toggleRowExpansion">toggleRowExpansion</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#toggleRowSelection">toggleRowSelection</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#updateAllSelected">updateAllSelected</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#updateColumns">updateColumns</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore.html#updateCurrentRow">updateCurrentRow</a></li></ul></li><li><a href="Popper.html">Popper</a><ul class='methods'><li data-type='method'><a href="Popper.html#_getPosition">_getPosition</a></li><li data-type='method'><a href="Popper.html#_getPosition">_getPosition</a></li><li data-type='method'><a href="Popper.html#destroy">destroy</a></li><li data-type='method'><a href="Popper.html#destroy">destroy</a></li><li data-type='method'><a href="Popper.html#isModifierRequired">isModifierRequired</a></li><li data-type='method'><a href="Popper.html#isModifierRequired">isModifierRequired</a></li><li data-type='method'><a href="Popper.html#onCreate">onCreate</a></li><li data-type='method'><a href="Popper.html#onCreate">onCreate</a></li><li data-type='method'><a href="Popper.html#onUpdate">onUpdate</a></li><li data-type='method'><a href="Popper.html#onUpdate">onUpdate</a></li><li data-type='method'><a href="Popper.html#parse">parse</a></li><li data-type='method'><a href="Popper.html#parse">parse</a></li><li data-type='method'><a href="Popper.html#runModifiers">runModifiers</a></li><li data-type='method'><a href="Popper.html#runModifiers">runModifiers</a></li><li data-type='method'><a href="Popper.html#update">update</a></li><li data-type='method'><a href="Popper.html#update">update</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-Date.html">Date</a><ul class='methods'><li data-type='method'><a href="module-Date.html#~parse">parse</a></li></ul></li><li><a href="module-ResizeEvent.html">ResizeEvent</a></li><li><a href="module-TableStoreModule.html">TableStoreModule</a><ul class='methods'><li data-type='method'><a href="module-TableStoreModule.html#~doFlattenColumns">doFlattenColumns</a></li><li data-type='method'><a href="module-TableStoreModule.html#~getKeysMap">getKeysMap</a></li><li data-type='method'><a href="module-TableStoreModule.html#~sortData">sortData</a></li><li data-type='method'><a href="module-TableStoreModule.html#~toggleRowExpansion">toggleRowExpansion</a></li><li data-type='method'><a href="module-TableStoreModule.html#~toggleRowSelection">toggleRowSelection</a></li></ul></li><li><a href="module-TableUtilModule.html">TableUtilModule</a><ul class='methods'><li data-type='method'><a href="module-TableUtilModule.html#~isObject">isObject</a></li></ul></li><li><a href="module-UtilModule.html">UtilModule</a><ul class='methods'><li data-type='method'><a href="module-UtilModule.html#.getPropByPath">getPropByPath</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="module-TableStoreModule-TableStore_mutations.html">mutations</a><ul class='methods'><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.changeSortCondition">changeSortCondition</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.filterChange">filterChange</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.insertColumn">insertColumn</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.removeColumn">removeColumn</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.rowSelectedChanged">rowSelectedChanged</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.setCurrentRow">setCurrentRow</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.setData">setData</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.setHoverRow">setHoverRow</a></li><li data-type='method'><a href="module-TableStoreModule-TableStore_mutations.html#.sort">sort</a></li></ul></li><li><a href="Popper.modifiers.html">modifiers</a><ul class='methods'><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.applyStyle">Popper#modifiers.applyStyle</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.applyStyle">Popper#modifiers.applyStyle</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.arrow">Popper#modifiers.arrow</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.arrow">Popper#modifiers.arrow</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.flip">Popper#modifiers.flip</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.flip">Popper#modifiers.flip</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.keepTogether">Popper#modifiers.keepTogether</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.keepTogether">Popper#modifiers.keepTogether</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.offset">Popper#modifiers.offset</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.offset">Popper#modifiers.offset</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.preventOverflow">Popper#modifiers.preventOverflow</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.preventOverflow">Popper#modifiers.preventOverflow</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.shift">Popper#modifiers.shift</a></li><li data-type='method'><a href="Popper.modifiers.html#.Popper#modifiers.shift">Popper#modifiers.shift</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">src/utils/aria-dialog.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Utils from './aria-utils';

/**
 * @constructor
 * @desc Dialog object providing modal focus management.
 *
 * Assumptions: The element serving as the dialog container is present in the
 * DOM and hidden. The dialog container has role='dialog'.
 *
 * @param dialogId
 *          The ID of the element serving as the dialog container.
 * @param focusAfterClosed
 *          Either the DOM node or the ID of the DOM node to focus when the
 *          dialog closes.
 * @param focusFirst
 *          Optional parameter containing either the DOM node or the ID of the
 *          DOM node to focus when the dialog opens. If not specified, the
 *          first focusable element in the dialog will receive focus.
 */
var aria = aria || {};
var tabEvent;

aria.Dialog = function(dialog, focusAfterClosed, focusFirst) {
  this.dialogNode = dialog;
  if (this.dialogNode === null || this.dialogNode.getAttribute('role') !== 'dialog') {
    throw new Error('Dialog() requires a DOM element with ARIA role of dialog.');
  }

  if (typeof focusAfterClosed === 'string') {
    this.focusAfterClosed = document.getElementById(focusAfterClosed);
  } else if (typeof focusAfterClosed === 'object') {
    this.focusAfterClosed = focusAfterClosed;
  } else {
    this.focusAfterClosed = null;
  }

  if (typeof focusFirst === 'string') {
    this.focusFirst = document.getElementById(focusFirst);
  } else if (typeof focusFirst === 'object') {
    this.focusFirst = focusFirst;
  } else {
    this.focusFirst = null;
  }

  if (this.focusFirst) {
    this.focusFirst.focus();
  } else {
    Utils.focusFirstDescendant(this.dialogNode);
  }

  this.lastFocus = document.activeElement;
  tabEvent = (e) => {
    this.trapFocus(e);
  };
  this.addListeners();
};

aria.Dialog.prototype.addListeners = function() {
  document.addEventListener('focus', tabEvent, true);
};

aria.Dialog.prototype.removeListeners = function() {
  document.removeEventListener('focus', tabEvent, true);
};

aria.Dialog.prototype.closeDialog = function() {
  this.removeListeners();
  if (this.focusAfterClosed) {
    setTimeout(() => {
      this.focusAfterClosed.focus();
    });
  }
};

aria.Dialog.prototype.trapFocus = function(event) {
  if (Utils.IgnoreUtilFocusChanges) {
    return;
  }
  if (this.dialogNode.contains(event.target)) {
    this.lastFocus = event.target;
  } else {
    Utils.focusFirstDescendant(this.dialogNode);
    if (this.lastFocus === document.activeElement) {
      Utils.focusLastDescendant(this.dialogNode);
    }
    this.lastFocus = document.activeElement;
  }
};

export default aria.Dialog;
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Nov 15 2018 19:20:48 GMT+0800 (GMT+08:00) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>


</body>
</html>
